{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>DarSign - Juego 2</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
<style>
* { margin:0; padding:0; box-sizing:border-box; }

body {
  background-image:url("{% static 'imagenes/fondo.png' %}");
  font-family:'Press Start 2P', cursive;
  background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
  color:#fff;
  display:flex;
  justify-content:center;
  padding:20px;
  min-height:100vh;
}

.container {
  background: rgba(0,0,0,0.75);
  border: 4px solid #8a2be2;
  border-radius: 20px;
  box-shadow: 0 0 30px #8a2be2;
  padding: 30px 40px;
  max-width: 600px;
  width: 100%;
  text-align:center;
  position: relative;
}

h1 {
  font-size: 1.8em;
  margin-bottom: 20px;
  text-shadow: 2px 2px 0 #000;
}

.game-container img {
  width: 180px;
  height: 180px;
  border: 4px solid #8a2be2;
  border-radius: 20px;
  background: white;
  object-fit: contain;
  margin-bottom: 25px;
}

.options {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.options button {
  font-family:'Press Start 2P', cursive;
  padding:18px 25px;
  font-size:1.2em;
  color:#fff;
  border:4px solid #8a2be2;
  border-radius:14px;
  background-color:#9b30ff;
  cursor:pointer;
  box-shadow:0 6px 0 #5a1abf;
  transition:0.3s;
}

.options button:hover {
  background-color:#7b1aff;
  transform:scale(1.05);
  text-shadow:2px 2px 5px #d1b3ff;
}

.options button:active {
  transform:translateY(4px);
  box-shadow:0 4px 0 #5a1abf;
}

.result {
  font-size: 1.2em;
  margin-top: 20px;
  font-weight:bold;
}

/* BotÃ³n volver igual al estilo de opciones */
button.volver {
  font-family:'Press Start 2P', cursive;
  padding:18px 25px;
  font-size:1.2em;
  color:#fff;
  border:4px solid #8a2be2;
  border-radius:14px;
  background-color:#9b30ff;
  cursor:pointer;
  box-shadow:0 6px 0 #5a1abf;
  transition:0.3s;
  margin-top:25px;
}

button.volver:hover {
  background-color:#7b1aff;
  transform:scale(1.05);
  text-shadow:2px 2px 5px #d1b3ff;
}

button.volver:active {
  transform:translateY(4px);
  box-shadow:0 4px 0 #5a1abf;
}

/* Mensaje estilo juego */
#message {
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%, -50%);
  background: rgba(0,0,0,0.85);
  border:4px solid #8a2be2;
  border-radius:20px;
  box-shadow:0 0 30px #8a2be2;
  padding:40px 50px;
  font-size:1.2em;
  display:none;
  flex-direction: column;
  align-items: center;
  z-index:10;
}

#message button {
  font-family:'Press Start 2P', cursive;
  padding:18px 25px;
  font-size:1.2em;
  color:#fff;
  border:4px solid #8a2be2;
  border-radius:14px;
  background-color:#9b30ff;
  cursor:pointer;
  box-shadow:0 6px 0 #5a1abf;
  transition:0.3s;
  margin-top:25px;
}

#message button:hover {
  background-color:#7b1aff;
  transform:scale(1.05);
  text-shadow:2px 2px 5px #d1b3ff;
}

#message button:active {
  transform:translateY(4px);
  box-shadow:0 4px 0 #5a1abf;
}

/* Responsivo */
@media(max-width:768px){
  .game-container img { width:140px; height:140px; }
  h1 { font-size:1.4em; }
  .options button { font-size:1em; padding:14px 20px; }
  #message { font-size:1em; padding:30px 35px; }
}
</style>
</head>
<body>

<div class="container">
  <h1>Â¿QuÃ© significa esta seÃ±a?</h1>
  <div class="game-container">
    <img id="question-image" src="" alt="Imagen de seÃ±a">
    <div class="options" id="options"></div>
    <p class="result" id="result"></p>
  </div>

  <a href="{% url 'juegos' %}"><button class="volver">Volver</button></a>

  <div id="message">
    <span>ðŸŽ‰ Â¡Excelente! Has respondido todas las preguntas ðŸŽ‰</span>
    <button id="restart">Reiniciar Juego</button>
  </div>
</div>

<script>
const cards = [
  { palabra: 'por favor', imagen: '{% static "imagenes/por favor.jpg" %}' },
  { palabra: 'no', imagen: '{% static "imagenes/no.jpg" %}' },
  { palabra: 'perdÃ³n', imagen: '{% static "imagenes/perdÃ³n.jpg" %}' },
  { palabra: 'sÃ­', imagen: '{% static "imagenes/sÃ­.jpg" %}' },
  { palabra: 'gracias', imagen: '{% static "imagenes/gracias.jpg" %}' }
];

const imageEl = document.getElementById("question-image");
const optionsEl = document.getElementById("options");
const resultEl = document.getElementById("result");
const messageBox = document.getElementById("message");
const restartBtn = document.getElementById("restart");

let remainingQuestions = [...cards];

function newQuestion() {
  resultEl.textContent = "";

  if(remainingQuestions.length === 0){
    messageBox.style.display = 'flex';
    return;
  }

  const correct = remainingQuestions[Math.floor(Math.random() * remainingQuestions.length)];

  let options = [correct.palabra];
  while (options.length < 3) {
    let randomWord = cards[Math.floor(Math.random() * cards.length)].palabra;
    if (!options.includes(randomWord)) options.push(randomWord);
  }

  options = options.sort(() => Math.random() - 0.5);

  imageEl.src = correct.imagen;

  optionsEl.innerHTML = "";
  options.forEach(opt => {
    const btn = document.createElement("button");
    btn.textContent = opt;
    btn.onclick = () => {
      if(opt === correct.palabra){
        resultEl.textContent = "âœ… Â¡Correcto!";
        resultEl.style.color = "lime";
        remainingQuestions = remainingQuestions.filter(q => q !== correct);
      } else {
        resultEl.textContent = "âŒ Incorrecto. Era: " + correct.palabra;
        resultEl.style.color = "red";
      }
      setTimeout(newQuestion, 1500);
    };
    optionsEl.appendChild(btn);
  });
}

restartBtn.addEventListener('click', ()=>{
  remainingQuestions = [...cards];
  messageBox.style.display = 'none';
  newQuestion();
});

newQuestion();
</script>

<audio id="musicaFondo" src="{% static 'sonidos/musica.mpeg' %}" loop autoplay></audio>

</body>
</html>
